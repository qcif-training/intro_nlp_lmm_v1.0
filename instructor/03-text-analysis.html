<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Introduction to Natural Language Processing for Research: Text Analysis</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #000">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../03-text-analysis.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Introduction to Natural Language Processing for Research
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Introduction to Natural Language Processing for Research
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to Natural Language Processing for Research
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 23%" class="percentage">
    23%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 23%" aria-valuenow="23" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../03-text-analysis.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction to Natural Language Processing</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-text-preprocessing.html">2. Introduction to Text Preprocessing</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3. Text Analysis
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction-to-text-analysis">3.1. Introduction to Text-Analysis</a></li>
<li><a href="#named-entity-recognition">3.1. Named Entity Recognition</a></li>
<li><a href="#topic-modeling">3.2. Topic Modeling</a></li>
<li><a href="#neural-networks">Neural Networks</a></li>
<li><a href="#convolutional-neural-networks">Convolutional Neural Networks</a></li>
<li><a href="#putting-it-all-together">Putting it all together</a></li>
<li><a href="#we-have-a-model-now-what">We have a model now what?</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-word-embedding.html">4. Word Embedding</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-transformers.html">5. Transformers for Natural Language Processing</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-llms.html">6. Large Language Models</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-domain-specific-llms.html">7. Domain-Specific LLMs</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-conclusion-final-project.html">8. Wrap-up and Final Project</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-text-preprocessing.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-word-embedding.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-text-preprocessing.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Introduction to Text
        </a>
        <a class="chapter-link float-end" href="../instructor/04-word-embedding.html" rel="next">
          Next: Word Embedding... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Text Analysis</h1>
        <p>Last updated on 2024-05-12 |
        
        <a href="https://github.com/qcif-training/intro_nlp_lmm_v1.0/edit/main/episodes/03-text-analysis.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What are text analysis methods?</li>
<li>How can I perform text analysis?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Define objectives associated with each one of the text analysis
techniques.</li>
<li>Implement named entity recognition, and topic modeling using Python
libraries and frameworks, such as NLTK, and Gensim.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="introduction-to-text-analysis"><h2 class="section-heading">3.1. Introduction to Text-Analysis<a class="anchor" aria-label="anchor" href="#introduction-to-text-analysis"></a>
</h2>
<hr class="half-width"><p>In this episode, we will learn how to analyze text data for NLP
tasks. We will explore some common techniques and methods for text
analysis, such as named entity recognition, topic modeling, and text
summarization. We will use some popular libraries and frameworks, such
as spaCy, NLTK, and Gensim, to implement these techniques and
methods.</p>
<div id="discussion" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discussion" class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h3>
<div class="callout-content">
<p>Teamwork: What are some of the goals of text analysis for NLP tasks
in your research field (e.g. material science)? Think of some examples
of NLP tasks that require text analysis, such as literature review,
patent analysis, or material discovery. How does text analysis help to
achieve these goals?</p>
</div>
</div>
</div>
<div id="discussion-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discussion-1" class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion-1"></a>
</h3>
<div class="callout-content">
<p>Teamwork: Name some of the common techniques in text analysis and
associating libraries. Briefly explain how they differ from each other
in terms of their objectives and required libraries.</p>
</div>
</div>
</div>
</section><section id="named-entity-recognition"><h2 class="section-heading">3.1. Named Entity Recognition<a class="anchor" aria-label="anchor" href="#named-entity-recognition"></a>
</h2>
<hr class="half-width"><p>Named Entity Recognition is a process of identifying and classifying
key elements in text into predefined categories. The categories could be
names of persons, organizations, locations, expressions of times,
quantities, monetary values, percentages, etc. Next, let’s discuss how
it works.</p>
<div id="discussion-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discussion-2" class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion-2"></a>
</h3>
<div class="callout-content">
<p>Teamwork: Discuss what tasks can be done with NER.</p>
<p>A: <em>NER can help with 1) categorizing resumes, 2) categorizing
customer feedback, 3) categorizing research papers, etc.</em></p>
</div>
</div>
</div>
<p>Using a text example from Wikipedia can help us to see how NER works.
Note that the spaCy library is a common framework here as well. Thus,
first, we make sure that the library is installed and imported:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>pip install spacy</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre>
</div>
<p>Create an NLP model (<em>nlp</em>) and download the small English
model from spaCy that is suitable for general tasks.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>nlp <span class="op">=</span> spacy.download(<span class="st">"en_core_web_sm"</span>)</span></code></pre>
</div>
<p>Create a variable to store your text and then apply the model to
process your text (text from <a href="https://en.wikipedia.org/wiki/Australian_Securities_Exchange" class="external-link">Wikipedia</a>):</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Text</h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>text = “Australian Shares Exchange Ltd (ASX) is an Australian public
company that operates Australia’s primary shares exchange, the
Australian Shares Exchange (sometimes referred to outside of Australia
as, or confused within Australia as, The Sydney Stock Exchange, a
separate entity). The ASX was formed on 1 April 1987, through
incorporation under legislation of the Australian Parliament as an
amalgamation of the six state securities exchanges, and merged with the
Sydney Futures Exchange in 2006. Today, ASX has an average daily
turnover of A$4.685 billion and a market capitalization of around A$1.6
trillion, making it one of the world’s top 20 listed exchange groups,
and the largest in the southern hemisphere. ASX Clear is the clearing
house for all shares, structured products, warrants and, ASX Equity
Derivatives.”</p>
</div>
</div>
</div>
</div>
<p>Use for loop to print all the named entities in the document:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>doc <span class="op">=</span> nlp(text)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>For ent <span class="kw">in</span> doc.ents</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>	Print(ent.text, ent.label_)</span></code></pre>
</div>
<p>The results will be:</p>
<pre><code>
output:

Australian Shares Exchange Ltd ORG
ASX ORG
Australian NORP
Australia GPE
the Australian Shares Exchange ORG
Australia GPE
Australia GPE
The Sydney Stock Exchange ORG
ASX ORG
1 April 1987 DATE
the Australian Parliament ORG
six CARDINAL
the Sydney Futures Exchange ORG
2006 DATE
Today DATE
ASX ORG
A$4.685 billion MONEY
around A$1.6 trillion MONEY
20 CARDINAL
</code></pre>
<div id="challenge" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge" class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge"></a>
</h3>
<div class="callout-content">
<p>Q: How can you interpret the labels in the output?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>A: You can use the following code to get information about each one
of the labels. For example, from we want to know what GPE represents
here. We can use <em>explain()</em> to get the required information:
spacy.explain(‘GPE’)</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>spacy.explain(‘GPE’)</span></code></pre>
</div>
<pre><code>Output: ‘Countries, cities, states’
</code></pre>
</div>
</div>
</div>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Q: Can we also use other libraries for NER analysis? Use the NLTK
library to perform named entity recognition on the following text:</p>
</div>
</div>
</div>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Text</h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" aria-labelledby="headingSpoiler2" data-bs-parent="#accordionSpoiler2">
<div class="accordion-body">
<p>text = ” Perovskite nanocrystals have emerged as a promising class of
materials for next-generation optoelectronic devices due to their unique
properties. Their crystal structure allows for tunable bandgaps, which
are the energy differences between occupied and unoccupied electronic
states. This tunability enables the creation of materials that can
absorb and emit light across a wide range of the electromagnetic
spectrum, making them suitable for applications like solar cells,
light-emitting diodes (LEDs), and lasers. Additionally, perovskite
nanocrystals exhibit high photoluminescence efficiencies, meaning they
can efficiently convert absorbed light into emitted light, further
adding to their potential for various optoelectronic applications.”</p>
</div>
</div>
</div>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge<em>(continued)</em><a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Print the original text and the list of named entities and their
types. You can use the following code to load the NLTK library and the
pre-trained model for named entity recognition:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>nltk.download(<span class="st">'maxent_ne_chunker'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>nltk.download(<span class="st">'words'</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>...</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>A: Download necessary NLTK resources and import the required
toolkit:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>nltk.download(<span class="st">'punkt'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>nltk.download(<span class="st">'averaged_perceptron_tagger'</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>nltk.download(<span class="st">'maxent_ne_chunker'</span>)</span></code></pre>
</div>
<p>Store the text:</p>
<div id="accordionSpoiler3" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler3" aria-expanded="false" aria-controls="collapseSpoiler3">
  <h3 class="accordion-header" id="headingSpoiler3">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Text</h3>
</button>
<div id="collapseSpoiler3" class="accordion-collapse collapse" aria-labelledby="headingSpoiler3" data-bs-parent="#accordionSpoiler3">
<div class="accordion-body">
<p>text = “Perovskite nanocrystals have emerged as a promising class of
materials for next-generation optoelectronic devices due to their unique
properties. Their crystal structure allows for tunable bandgaps, which
are the energy differences between occupied and unoccupied electronic
states. This tunability enables the creation of materials that can
absorb and emit light across a wide range of the electromagnetic
spectrum, making them suitable for applications like solar cells,
light-emitting diodes (LEDs), and lasers. Additionally, perovskite
nanocrystals exhibit high photoluminescence efficiencies, meaning they
can efficiently convert absorbed light into emitted light, further
adding to their potential for various optoelectronic applications.”</p>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># Tokenize the text:</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>tokens <span class="op">=</span> nltk.word_tokenize(text)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># Assign part-of-speech tags:</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>pos_tags <span class="op">=</span> nltk.pos_tag(tokens)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co"># Perform named entity recognition:</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>named_entities <span class="op">=</span> nltk.ne_chunk(pos_tags)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co"># Print the original text:</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original Text:"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="bu">print</span>(text)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co"># Print named entities and their types:</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Named Entities:"</span>)</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="cf">for</span> entity <span class="kw">in</span> named_entities:</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>   <span class="cf">if</span> <span class="bu">type</span>(entity) <span class="op">==</span> nltk.Tree:</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>   <span class="bu">print</span>(<span class="ss">f"Entity: </span><span class="sc">{</span><span class="st">''</span><span class="sc">.</span>join(word <span class="cf">for</span> word, _ <span class="kw">in</span> entity.leaves())<span class="sc">}</span><span class="ss">, Type: </span><span class="sc">{</span>entity<span class="sc">.</span>label()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre>
</div>
<div id="accordionSpoiler4" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler4" aria-expanded="false" aria-controls="collapseSpoiler4">
  <h3 class="accordion-header" id="headingSpoiler4">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Output</h3>
</button>
<div id="collapseSpoiler4" class="accordion-collapse collapse" aria-labelledby="headingSpoiler4" data-bs-parent="#accordionSpoiler4">
<div class="accordion-body">
<p>Original Text: Perovskite nanocrystals have emerged as a promising
class of materials for next-generation optoelectronic devices due to
their unique properties. Their crystal structure allows for tunable
bandgaps, which are the energy differences between occupied and
unoccupied electronic states. This tunability enables the creation of
materials that can absorb and emit light across a wide range of the
electromagnetic spectrum, making them suitable for applications like
solar cells, light-emitting diodes (LEDs), and lasers. Additionally,
perovskite nanocrystals exhibit high photoluminescence efficiencies,
meaning they can efficiently convert absorbed light into emitted light,
further adding to their potential for various optoelectronic
applications.</p>
<ul><li>Named Entities:</li>
<li>Entity: Perovskite, Type: ORGANIZATION</li>
<li>Entity: light-emitting diodes (LEDs), Type: ORGANIZATION</li>
</ul><p>[((‘Perovskite’, ‘NNP’), ‘ORGANIZATION’), (‘nanocrystals’, ‘NNP’),
(‘have’, ‘VBP’), (‘emerged’, ‘VBD’), (‘as’, ‘IN’), (‘a’, ‘DT’),
(‘promising’, ‘JJ’), (‘class’, ‘NN’), (‘of’, ‘IN’), (‘materials’,
‘NNS’), (‘for’, ‘IN’), (‘next-generation’, ‘JJ’), (‘optoelectronic’,
‘JJ’), (‘devices’, ‘NNS’), (‘due’, ‘IN’), (‘to’, ‘TO’), (‘their’,
‘PRP<span class="math inline">\('), ('unique',
'JJ'), ('properties', 'NNS'), ('.',
'.'), ('Their', 'PRP\)</span>’), (‘crystal’, ‘NN’),
(‘structure’, ‘NN’), (‘allows’, ‘VBZ’), (‘for’, ‘IN’), (‘tunable’,
‘JJ’), (‘bandgaps’, ‘NNS’), (‘,’, ‘,’), (‘which’, ‘WDT’), (‘are’,
‘VBP’), (‘the’, ‘DT’), (‘energy’, ‘NN’), (‘differences’, ‘NNS’),
(‘between’, ‘IN’), (‘occupied’, ‘VBN’), (‘and’, ‘CC’), (‘unoccupied’,
‘VBN’), (‘electronic’, ‘JJ’), (‘states’, ‘NNS’), (‘.’, ‘.’), (‘This’,
‘DT’), (‘tunability’, ‘NN’), (‘enables’, ‘VBZ’), (‘the’, ‘DT’),
(‘creation’, ‘NN’), (‘of’, ‘IN’), (‘materials’, ‘NNS’), (‘that’, ‘WDT’),
(‘can’, ‘MD’), (‘absorb’, ‘VB’), (‘and’, ‘CC’), (‘emit’, ‘VB’),
(‘light’, ‘NN’), (‘across’, ‘IN’), (‘a’, ‘DT’), (‘wide’, ‘JJ’),
(‘range’, ‘NN’), (‘of’, ‘IN’), (‘the’, ‘DT’), (‘electromagnetic’, ‘JJ’),
(‘spectrum’, ‘NN’), (‘,’, ‘,’), (‘making’, ‘VBG’), (‘them’, ‘PRP’),
(‘suitable’, ‘JJ’), (‘for’, ‘IN’), (‘applications’, ‘NNS’), (‘like’,
‘IN’), (‘solar’, ‘JJ’), (‘cells’, ‘NNS’), (‘,’, ‘,’), (‘light-emitting’,
‘JJ’), (‘diodes’, ‘NNS’), (‘(’, ‘(’, ‘LEDs’, ‘NNPS’), ‘)’, ‘)’), (‘and’,
‘CC’), (‘lasers’, ‘NNS’), (‘.’, ‘.’), (‘Additionally’, ‘RB’), (‘,’,
‘,’), (‘perovskite’, ‘NNP’), (‘nanocrystals’, ‘NNP’), (‘exhibit’,
‘VBP’), (‘high’, ‘JJ’), (‘photoluminescence’, ‘NN’), (‘efficiencies’,
‘NNS’), (‘,’, ‘,’), (‘meaning’, ‘VBG’), (‘they’, ‘PRP’), (‘can’, ‘MD’),
(‘efficiently’, ‘RB’), (‘convert’, ‘VB’), (‘absorbed’, ‘VBN’), (‘light’,
‘NN’), (‘into’, ‘IN’), (‘emitted’, ‘VBN’), (‘light’, ‘NN’), (‘,’, ‘,’),
(‘further’, ‘RB’), (‘adding’, ‘VBG’), (‘to’, ‘TO’), (‘their’, ‘PRP$’),
(‘potential’, ‘NN’), (‘for’, ‘IN’), (‘various’, ‘JJ’),
(‘optoelectronic’, ‘JJ’), (‘applications’, ‘NNS’), (‘.’, ‘.’)]</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="why-ner" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="why-ner" class="callout-inner">
<h3 class="callout-title">Why NER?<a class="anchor" aria-label="anchor" href="#why-ner"></a>
</h3>
<div class="callout-content">
<p>When do we need to perform NER for your research?</p>
<p>NER helps in quickly finding specific information in large datasets,
which is particularly useful in research fields for categorizing the
text based on the entities. NER is also called entity chunking and
entity extraction.</p>
</div>
</div>
</div>
</section><section id="topic-modeling"><h2 class="section-heading">3.2. Topic Modeling<a class="anchor" aria-label="anchor" href="#topic-modeling"></a>
</h2>
<hr class="half-width"><p>Topic Modeling is an unsupervised model for discovering the abstract
“topics” that occur in a collection of documents. It is useful in
understanding the main themes of a large corpus of text. To better
understand this and to find the connection between concepts we have
learned so far, let’s match the following terms to their brief
definitions:</p>
<div id="discussion-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discussion-3" class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion-3"></a>
</h3>
<div class="callout-content">
<p>Teamwork: To better understand this and to find the connection
between concepts we have learned so far, let’s match the following terms
to their brief definitions:</p>
<figure><img src="https://github.com/qcif-training/intro_nlp_lmm_v1.0/assets/45458783/2be22cfb-4ed8-4f65-85bf-31962a40835f" alt="image" class="figure mx-auto d-block"><div class="figcaption">image</div>
</figure></div>
</div>
</div>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout2"></a>
</h3>
<div class="callout-content">
<p>There are some new concepts in this section that are new to you.
Although a detailed explanation of these concepts is out of the scope of
this workshop we learn their basic definitions. You already learned a
few of them in the earlier activity. Another one is Bag-of-words. We
will learn more about Bag-of-words (BoW) in episode 5. BoW is defined as
a representation of text that describes the occurrence of words within a
document. It is needed in the topic modeling analysis to view the
frequency of the words in a document regardless of the order of the
words in the text.</p>
</div>
</div>
</div>
<p>To see how Topic Modeling can help us in action to classify a text,
let’s see the following example. We need to install the <em>Gensim</em>
library and import the necessary modules:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>pip install genism</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="im">from</span> gensim <span class="im">import</span> corpora</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> LdaModel</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="im">from</span> gensim.utils <span class="im">import</span> simple_preprocess</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span></code></pre>
</div>
<p>at this stage, we preprocess including the text tokenization (text
from <a href="https://en.wikipedia.org/wiki/Australian_Securities_Exchange" class="external-link">Wikipedia</a>):</p>
<div id="accordionSpoiler5" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler5" aria-expanded="false" aria-controls="collapseSpoiler5">
  <h3 class="accordion-header" id="headingSpoiler5">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Text</h3>
</button>
<div id="collapseSpoiler5" class="accordion-collapse collapse" aria-labelledby="headingSpoiler5" data-bs-parent="#accordionSpoiler5">
<div class="accordion-body">
<p>text = “Australian Shares Exchange Ltd (ASX) is an Australian public
company that operates Australia’s primary shares exchange, the
Australian Shares Exchange (sometimes referred to outside of Australia
as, or confused within Australia as, The Sydney Stock Exchange, a
separate entity). The ASX was formed on 1 April 1987, through
incorporation under legislation of the Australian Parliament as an
amalgamation of the six state securities exchanges and merged with the
Sydney Futures Exchange in 2006. Today, ASX has an average daily
turnover of A$4.685 billion and a market capitalisation of around A$1.6
trillion, making it one of the world’s top 20 listed exchange groups,
and the largest in the southern hemisphere. ASX Clear is the clearing
house for all shares, structured products, warrants and ASX Equity
Derivatives. ASX Group[3] is a market operator, clearing house and
payments system facilitator. It also oversees compliance with its
operating rules, promotes standards of corporate governance among
Australia’s listed companies and helps to educate retail investors.
Australia’s capital markets. Financial development – Australia was
ranked 5th out of 57 of the world’s leading financial systems and
capital markets by the World Economic Forum; Equity market – the 8th
largest in the world (based on free-float market capitalisation) and the
2nd largest in Asia-Pacific, with A$1.2 trillion market capitalisation
and average daily secondary trading of over A$5 billion a day; Bond
market – 3rd largest debt market in the Asia Pacific; Derivatives market
– largest fixed income derivatives in the Asia-Pacific region; Foreign
exchange market – the Australian foreign exchange market is the 7th
largest in the world in terms of global turnover, while the Australian
dollar is the 5th most traded currency and the AUD/USD the 4th most
traded currency pair; Funds management – Due in large part to its
compulsory superannuation system, Australia has the largest pool of
funds under management in the Asia-Pacific region, and the 4th largest
in the world. Its primary markets are the AQUA Markets. Regulation. The
Australian Securities &amp; Investments Commission (ASIC) has
responsibility for the supervision of real-time trading on Australia’s
domestic licensed financial markets and the supervision of the conduct
by participants (including the relationship between participants and
their clients) on those markets. ASIC also supervises ASX’s own
compliance as a public company with ASX Listing Rules. ASX Compliance is
an ASX subsidiary company that is responsible for monitoring and
enforcing ASX-listed companies’ compliance with the ASX operating rules.
The Reserve Bank of Australia (RBA) has oversight of the ASX’s clearing
and settlement facilities for financial system stability. In November
1903 the first interstate conference was held to coincide with the
Melbourne Cup. The exchanges then met on an informal basis until 1937
when the Australian Associated Stock Exchanges (AASE) was established,
with representatives from each exchange. Over time the AASE established
uniform listing rules, broker rules, and commission rates. Trading was
conducted by a call system, where an exchange employee called the names
of each company and brokers bid or offered on each. In the 1960s this
changed to a post system. Exchange employees called”chalkies” wrote bids
and offers in chalk on blackboards continuously, and recorded
transactions made. The ASX (Australian Stock Exchange Limited) was
formed in 1987 by legislation of the Australian Parliament which enabled
the amalgamation of six independent stock exchanges that formerly
operated in the state capital cities. After demutualisation, the ASX was
the first exchange in the world to have its shares quoted on its own
market. The ASX was listed on 14 October 1998.[7] On 7 July 2006 the
Australian Stock Exchange merged with SFE Corporation, holding company
for the Sydney Futures Exchange. Trading system. ASX Group has two
trading platforms – ASX Trade,[12] which facilitates the trading of ASX
equity securities and ASX Trade24 for derivative securities trading. All
ASX equity securities are traded on screen on ASX Trade. ASX Trade is a
NASDAQ OMX ultra-low latency trading platform based on NASDAQ OMX’s
Genium INET system, which is used by many exchanges around the world. It
is one of the fastest and most functional multi-asset trading platforms
in the world, delivering latency down to ~250 microseconds. ASX Trade24
is ASX global trading platform for derivatives. It is globally
distributed with network access points (gateways) located in Chicago,
New York, London, Hong Kong, Singapore, Sydney and Melbourne. It also
allows for true 24-hour trading, and simultaneously maintains two active
trading days which enables products to be opened for trading in the new
trading day in one time zone while products are still trading under the
previous day. Opening times. The normal trading or business days of the
ASX are week-days, Monday to Friday. ASX does not trade on national
public holidays: New Year’s Day (1 January), Australia Day (26 January,
and observed on this day or the first business day after this date),
Good Friday (that varies each year), Easter Monday, Anzac day (25
April), Queen’s birthday (June), Christmas Day (25 December) and Boxing
Day (26 December). On each trading day there is a pre-market session
from 7:00 am to 10:00 am AEST and a normal trading session from 10:00 am
to 4:00 pm AEST. The market opens alphabetically in single-price
auctions, phased over the first ten minutes, with a small random time
built in to prevent exact prediction of the first trades. There is also
a single-price auction between 4:10 pm and 4:12 pm to set the daily
closing prices. Settlement. Security holders hold shares in one of two
forms, both of which operate as uncertificated holdings, rather than
through the issue of physical share certificates: Clearing House
Electronic Sub-register System (CHESS). The investor’s controlling
participant (normally a broker) sponsors the client into CHESS. The
security holder is given a “holder identification number” (HIN) and
monthly statements are sent to the security holder from the CHESS system
when there is a movement in their holding that month. Issuer-sponsored.
The company’s share register administers the security holder’s holding
and issues the investor with a security-holder reference number (SRN)
which may be quoted when selling. Holdings may be moved from
issuer-sponsored to CHESS or between different brokers by electronic
message initiated by the controlling participant. Short selling. Main
article: Short (finance). Short selling of shares is permitted on the
ASX, but only among designated stocks and with certain conditions: ASX
trading participants (brokers) must report all daily gross short sales
to ASX. The report will aggregate the gross short sales as reported by
each trading participant at an individual stock level. ASX publishes
aggregate gross short sales to ASX participants and the general
public.[13] Many brokers do not offer short selling to small private
investors. LEPOs can serve as an equivalent, while contracts for
difference (CFDs) offered by third-party providers are another
alternative. In September 2008, ASIC suspended nearly all forms of short
selling due to concerns about market stability in the ongoing global
financial crisis.[14][15] The ban on covered short selling was lifted in
May 2009.[16] Also, in the biggest change for ASX in 15 years, ASTC
Settlement Rule 10.11.12 was introduced, which requires the broker to
provide stocks when settlement is due, otherwise the broker must buy the
stock on the market to cover the shortfall. The rule requires that if a
Failed Settlement Shortfall exists on the second business day after the
day on which the Rescheduled Batch Instruction was originally scheduled
for settlement (that is, generally on T+5), the delivering settlement
participant must either: close out the Failed Settlement Shortfall on
the next business day by purchasing the number of Financial Products of
the relevant class equal to the shortfall; or acquire under a securities
lending arrangement the number of Financial Products of the relevant
class equal to the shortfall and deliver those Financial Products in
Batch Settlement no more than two business days later.[17] Options.
Options on leading shares are traded on the ASX, with standardised sets
of strike prices and expiry dates. Liquidity is provided by market
makers who are required to provide quotes. Each market maker is assigned
two or more stocks. A stock can have more than one market maker, and
they compete with one another. A market maker may choose one or both of:
Make a market continuously, on a set of 18 options. Make a market in
response to a quote request, in any option up to 9 months out. In both
cases there is a minimum quantity (5 or 10 contracts depending on the
shares) and a maximum spread permitted. Due to the higher risks in
options, brokers must check clients’ suitability before allowing them to
trade options. Clients may both take (i.e. buy) and write (i.e. sell)
options. For written positions, the client must put up margin. Interest
rate market. The ASX interest rate market is the set of corporate bonds,
floating rate notes, and bond-like preference shares listed on the
exchange. These securities are traded and settled in the same way as
ordinary shares, but the ASX provides information such as their
maturity, effective interest rate, etc., to aid comparison.[18] Futures.
The Sydney Futures Exchange (SFE) was the 10th largest derivatives
exchange in the world, providing derivatives in interest rates,
equities, currencies and commodities. The SFE is now part of ASX and its
most active products are: SPI 200 Futures – Futures contracts on an
index representing the largest 200 stocks on the Australian Stock
Exchange by market capitalisation. AU 90-day Bank Accepted Bill Futures
– Australia’s equivalent of T-Bill futures. 3-Year Bond Futures –
Futures contracts on Australian 3-year bonds. 10-Year Bond Futures –
Futures contracts on Australian 10-year bonds. The ASX trades futures
over the ASX 50, ASX 200 and ASX property indexes, and over grain,
electricity and wool. Options over grain futures are also traded. Market
indices. The ASX maintains stock indexes concerning stocks traded on the
exchange in conjunction with Standard &amp; Poor’s. There is a hierarchy
of index groups called the S&amp;P/ASX 20, S&amp;P/ASX 50, S&amp;P/ASX
100, S&amp;P/ASX 200 and S&amp;P/ASX 300, notionally containing the 20,
50, 100, 200 and 300 largest companies listed on the exchange, subject
to some qualifications. Sharemarket Game. The ASX Sharemarket Game give
members of the public and secondary school students the chance to learn
about investing in the sharemarket using real market prices.
Participants receive a hypothetical $50,000 to buy and sell shares in
150 companies and track the progress of their investments over the
duration of the game.[19] Merger talks with SGX. ASX was (25 October
2010) in merger talks with Singapore Exchange (SGX). While there was an
initial expectation that the merger would have created a bourse with a
market value of US$14 billion,[20] this was a misconception; the final
proposal intended that the ASX and SGX bourses would have continued
functioning separately. The merger was blocked by Treasurer of Australia
Wayne Swan on 8 April 2011, on advice from the Foreign Investment Review
Board that the proposed merger was not in the best interests of
Australia.[21]”</p>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>tokens <span class="op">=</span> simple_preprocess(text)</span></code></pre>
</div>
<p>For Topic Modeling we need to map each word to a unique ID through
creating a dictionary:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>dictionary <span class="op">=</span> corpora.Dictionary([tokens])</span></code></pre>
</div>
<p>And the created dictionary should be converted into a bag-of-words.
We do that with doc2bow().</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>corpus <span class="op">=</span> [dictionary.doc2bow(tokens)]</span></code></pre>
</div>
<p>Next, we use Latent Dirichlet Allocation (LDA) which is a popular
topic modeling technique because it assumes documents are produced from
a mixture of topics. These topics then generate words based on their
probability distribution. Set up the LDA model with the number of topics
and train it on the corpus:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>lda_model <span class="op">=</span> LdaModel(corpus<span class="op">=</span>corpus, id2word<span class="op">=</span>dictionary, num_topics<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<p>Finally, we can print the topics and their word distributions from
our text:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>topics <span class="op">=</span> lda_model.print_topics(num_words<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="cf">for</span> topic <span class="kw">in</span> topics:</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="bu">print</span>(topic)</span></code></pre>
</div>
<div id="discussion-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discussion-4" class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion-4"></a>
</h3>
<div class="callout-content">
<p>Teamwork: How does the topic modeling method help researchers? What
about the text summarization? What are some of the challenges and
limitations of text analysis in your research field (material science)?
Consider some of the factors that affect the quality and accuracy of
text analysis, such as data availability, language diversity, and domain
specificity. How do these factors pose problems or difficulties for text
analysis in material science?</p>
</div>
</div>
</div>
<div id="chemistry-joke" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="chemistry-joke" class="callout-inner">
<h3 class="callout-title">Chemistry Joke<a class="anchor" aria-label="anchor" href="#chemistry-joke"></a>
</h3>
<div class="callout-content">
<p>Q: Use the Gensim library to perform topic modeling on the following
text, print the original text and the list of topics and their
keywords.</p>
</div>
</div>
</div>
<div id="accordionSpoiler6" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler6" aria-expanded="false" aria-controls="collapseSpoiler6">
  <h3 class="accordion-header" id="headingSpoiler6">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Text</h3>
</button>
<div id="collapseSpoiler6" class="accordion-collapse collapse" aria-labelledby="headingSpoiler6" data-bs-parent="#accordionSpoiler6">
<div class="accordion-body">
<p>text = ” Perovskite nanocrystals have emerged as a promising class of
materials for next-generation optoelectronic devices due to their unique
properties. Their crystal structure allows for tunable bandgaps, which
are the energy differences between occupied and unoccupied electronic
states. This tunability enables the creation of materials that can
absorb and emit light across a wide range of the electromagnetic
spectrum, making them suitable for applications like solar cells,
light-emitting diodes (LEDs), and lasers. Additionally, perovskite
nanocrystals exhibit high photoluminescence efficiencies, meaning they
can efficiently convert absorbed light into emitted light, further
adding to their potential for various optoelectronic applications.”</p>
</div>
</div>
</div>
</div>
<div id="chemistry-joke" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="chemistry-joke" class="callout-inner">
<h3 class="callout-title">Chemistry Joke<em>(continued)</em><a class="anchor" aria-label="anchor" href="#chemistry-joke"></a>
</h3>
<div class="callout-content">
<p>You can use the following code to load the Gensim library and the
pre-trained model for topic modeling:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="im">from</span> gensim <span class="im">import</span> corpora</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> LdaModel</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="im">from</span> gensim.utils <span class="im">import</span> simple_preprocess</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>A:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="im">from</span> gensim <span class="im">import</span> corpora</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> LdaModel</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="im">from</span> gensim.utils <span class="im">import</span> simple_preprocess</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>tokens <span class="op">=</span> simple_preprocess(text)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>dictionary <span class="op">=</span> corpora.Dictionary([tokens])</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>corpus <span class="op">=</span> [dictionary.doc2bow(tokens)]</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>model <span class="op">=</span> LdaModel(corpus, num_topics<span class="op">=</span><span class="dv">2</span>, id2word<span class="op">=</span>dictionary)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="bu">print</span>(text)</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="bu">print</span>(model.print_topics())</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="chemistry-joke-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="chemistry-joke-1" class="callout-inner">
<h3 class="callout-title">Chemistry Joke<a class="anchor" aria-label="anchor" href="#chemistry-joke-1"></a>
</h3>
<div class="callout-content">
<p>Q: Use the genism to perform topic modeling on the following two
different texts and provide a comparison.</p>
</div>
</div>
</div>
<div id="accordionSpoiler7" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler7" aria-expanded="false" aria-controls="collapseSpoiler7">
  <h3 class="accordion-header" id="headingSpoiler7">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Text</h3>
</button>
<div id="collapseSpoiler7" class="accordion-collapse collapse" aria-labelledby="headingSpoiler7" data-bs-parent="#accordionSpoiler7">
<div class="accordion-body">
<p>text1 = “Perovskite nanocrystals have emerged as a promising class of
materials for next-generation optoelectronic devices due to their unique
properties. Their crystal structure allows for tunable bandgaps, which
are the energy differences between occupied and unoccupied electronic
states. This tunability enables the creation of materials that can
absorb and emit light across a wide range of the electromagnetic
spectrum, making them suitable for applications like solar cells,
light-emitting diodes (LEDs), and lasers. Additionally, perovskite
nanocrystals exhibit high photoluminescence efficiencies, meaning they
can efficiently convert absorbed light into emitted light, further
adding to their potential for various optoelectronic applications.”</p>
<p>text2 = “Graphene is a one-atom-thick sheet of carbon atoms arranged
in a honeycomb lattice. It is a remarkable material with unique
properties, including high electrical conductivity, thermal
conductivity, mechanical strength, and optical transparency. Graphene
has the potential to revolutionize various fields, including
electronics, photonics, and composite materials. Due to its excellent
electrical conductivity, graphene is a promising candidate for
next-generation electronic devices, such as transistors and sensors.
Additionally, its high thermal conductivity makes it suitable for heat
dissipation applications.”</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>A: After storing the two texts in text1 and text2, preprocess the
text (e.g., tokenization, stop word removal, stemming/lemmatization).
Split the texts into documents:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="im">from</span> gensim <span class="im">import</span> corpora</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>documents <span class="op">=</span> [text1.split(), text2.split()]</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co"># Create a dictionary:</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>dictionary <span class="op">=</span> corpora.Dictionary(documents)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co"># Create a corpus (bag of words representation):</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>corpus <span class="op">=</span> [dictionary.doc2bow(doc) <span class="cf">for</span> doc <span class="kw">in</span> documents]</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co"># Train the LDA model (adjust num_topics as needed):</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>lda_model <span class="op">=</span> gensim.models.LdaModel(corpus, id2word<span class="op">=</span>dictionary, num_topics<span class="op">=</span><span class="dv">3</span>, passes<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co"># Print the original texts:</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original Texts:"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Text 1:</span><span class="ch">\n</span><span class="sc">{</span>text1<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Text 2:</span><span class="ch">\n</span><span class="sc">{</span>text2<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co"># Identify shared and distinct keywords for each topic:</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Topics and Keywords:"</span>)</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="cf">for</span> topic <span class="kw">in</span> lda_model.show_topics(formatted<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Topic </span><span class="sc">{</span>topic[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>    topic_words <span class="op">=</span> [w[<span class="dv">0</span>] <span class="cf">for</span> w <span class="kw">in</span> topic[<span class="dv">1</span>]]</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Text 1 Keywords:"</span>, [w <span class="cf">for</span> w <span class="kw">in</span> topic_words <span class="cf">if</span> w <span class="kw">in</span> text1])</span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Text 2 Keywords:"</span>, [w <span class="cf">for</span> w <span class="kw">in</span> topic_words <span class="cf">if</span> w <span class="kw">in</span> text2])</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co"># Explain the conceptual similarity:</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Conceptual Similarity:"</span>)</span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Both texts discuss novel materials (perovskite nanocrystals and graphene) with unique properties. While the specific applications and functionalities differ slightly, they both highlight the potential of these materials for various technological advancements."</span>)</span></code></pre>
</div>
<div id="accordionSpoiler8" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler8" aria-expanded="false" aria-controls="collapseSpoiler8">
  <h3 class="accordion-header" id="headingSpoiler8">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Output</h3>
</button>
<div id="collapseSpoiler8" class="accordion-collapse collapse" aria-labelledby="headingSpoiler8" data-bs-parent="#accordionSpoiler8">
<div class="accordion-body">
<p>Original Texts:</p>
<p>Text 1: Perovskite nanocrystals have emerged as a promising class of
materials for next-generation optoelectronic devices due to their unique
properties. Their crystal structure allows for tunable bandgaps, which
are the energy differences between occupied and unoccupied electronic
states. This tunability enables the creation of materials that can
absorb and emit light across a wide range of the electromagnetic
spectrum, making them suitable for applications like solar cells,
light-emitting diodes (LEDs), and lasers. Additionally, perovskite
nanocrystals exhibit high photoluminescence efficiencies, meaning they
can efficiently convert absorbed light into emitted light, further
adding to their potential for various optoelectronic applications.</p>
<p>Text 2: Graphene is a one-atom-thick sheet of carbon atoms arranged
in a honeycomb lattice. It is a remarkable material with unique
properties, including high electrical conductivity, thermal
conductivity, mechanical strength, and optical transparency. Graphene
has the potential to revolutionize various fields, including
electronics, photonics, and composite materials. Due to its excellent
electrical conductivity, graphene is a promising candidate for
next-generation electronic devices, such as transistors and sensors.
Additionally, its high thermal conductivity makes it suitable for heat
dissipation applications.</p>
<p>Topics and Keywords:</p>
<pre><code>Topic 0:

Text 1 Keywords: ['applications', 'devices', 'material', 'optoelectronic', 'properties']
Text 2 Keywords: ['applications', 'conductivity', 'electronic', 'graphene', 'material', 'potential']

Topic 1:
	
Text 1 Keywords: ['bandgaps', 'crystal', 'electronic', 'properties', 'structure']
Text 2 Keywords: ['conductivity', 'electrical', 'graphene', 'material', 'properties']

Topic 2:

Text 1 Keywords: ['absorption', 'emit', 'light', 'spectrum']
Text 2 Keywords: ['conductivity', 'graphene', 'material', 'optical', 'potential']</code></pre>
<p>Conceptual Similarity:</p>
<p>Both texts discuss novel materials (perovskite nanocrystals and
graphene) with unique properties. While the specific applications and
functionalities differ slightly (optoelectronic devices vs. electronic
devices), they both highlight the potential of these materials for
various technological advancements. Notably, both topics identify
“material,” “properties,” and “applications” as keywords, suggesting a
shared focus on the materials’ characteristics and their potential uses.
Additionally, keywords like “electronic,” “conductivity,” and
“potential” appear in both texts within different topics, indicating a
conceptual overlap in exploring the electronic properties and potential
applications of these materials.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>Q: Use the Gensim library to perform topic modeling on the following
text print the original text and the list of topics and their
keywords.</p>
</div>
</div>
</div>
<div id="accordionSpoiler9" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler9" aria-expanded="false" aria-controls="collapseSpoiler9">
  <h3 class="accordion-header" id="headingSpoiler9">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Text</h3>
</button>
<div id="collapseSpoiler9" class="accordion-collapse collapse" aria-labelledby="headingSpoiler9" data-bs-parent="#accordionSpoiler9">
<div class="accordion-body">
<p>text = “Natural language processing (NLP) is a subfield of computer
science, information engineering, and artificial intelligence concerned
with the interactions between computers and human (natural) languages,
in particular how to program computers to process and analyze large
amounts of natural language data. Challenges in natural language
processing frequently involve speech recognition, natural language
understanding, and natural language generation.”</p>
</div>
</div>
</div>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge<em>(continued)</em><a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>You can use the following code to load the Gensim library and the
pre-trained model for topic modeling:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="im">from</span> gensim <span class="im">import</span> corpora</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> LdaModel</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="im">from</span> gensim.utils <span class="im">import</span> simple_preprocess</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>A:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="im">from</span> gensim <span class="im">import</span> corpora</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> LdaModel</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="im">from</span> gensim.utils <span class="im">import</span> simple_preprocess</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>tokens <span class="op">=</span> simple_preprocess(text)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>dictionary <span class="op">=</span> corpora.Dictionary([tokens])</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>corpus <span class="op">=</span> [dictionary.doc2bow(tokens)]</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>model <span class="op">=</span> LdaModel(corpus, num_topics<span class="op">=</span><span class="dv">2</span>, id2word<span class="op">=</span>dictionary)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="bu">print</span>(text)</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="bu">print</span>(model.print_topics())</span></code></pre>
</div>
<pre><code>
output = Natural language processing (NLP) is a subfield of computer science, information engineering, and artificial intelligence concerned with the interactions between computers and human (natural) languages, in particular how to program computers to process and analyze large amounts of natural language data. Challenges in natural language processing frequently involve speech recognition, natural language understanding, and natural language generation.

[(0, '0.051*"natural" + 0.051*"language" + 0.051*"processing" + 0.027*"nlp" + 0.027*"challenges" + 0.027*"speech" + 0.027*"recognition" + 0.027*"understanding" + 0.027*"generation" + 0.027*"frequently"'), (1, '0.051*"natural" + 0.051*"language" + 0.051*"computers" + 0.027*"interactions" + 0.027*"between" + 0.027*"human" + 0.027*"languages" + 0.027*"particular" + 0.027*"program" + 0.027*"process"')]

</code></pre>
</div>
</div>
</div>
</div>
<div id="callout3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout3"></a>
</h3>
<div class="callout-content">
<p>This is a callout block. It contains at least three colons</p>
</div>
</div>
</div>
<div id="accordionSpoiler10" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler10" aria-expanded="false" aria-controls="collapseSpoiler10">
  <h3 class="accordion-header" id="headingSpoiler10">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>What Else Might We Use A Spoiler For?</h3>
</button>
<div id="collapseSpoiler10" class="accordion-collapse collapse" aria-labelledby="headingSpoiler10" data-bs-parent="#accordionSpoiler10">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="chemistry-joke-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="chemistry-joke-2" class="callout-inner">
<h3 class="callout-title">Chemistry Joke<a class="anchor" aria-label="anchor" href="#chemistry-joke-2"></a>
</h3>
<div class="callout-content">
<p>Q: If you aren’t part of the solution, then what are you?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Show me the solution</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<p>A: part of the precipitate</p>
</div>
</div>
</div>
</div>
</section><section id="neural-networks"><h2 class="section-heading">Neural Networks<a class="anchor" aria-label="anchor" href="#neural-networks"></a>
</h2>
<hr class="half-width"><p>A <strong>neural network</strong> is an artificial intelligence
technique loosely based on the way neurons in the brain work.</p>
<div class="section level3">
<h3 id="a-single-nueron">A single nueron<a class="anchor" aria-label="anchor" href="#a-single-nueron"></a></h3>
<p>A neural network consists of connected computational units called
<strong>neurons</strong>. Each neuron will:</p>
<ul><li>Take one or more inputs (<span class="math inline">\(x_1, x_2,
...\)</span>), e.g., input data expressed as floating point
numbers.</li>
<li>Conduct three main operations most of the time:
<ul><li>Calculate the weighted sum of the inputs where ($w_1, w_2, … $)
indicate weights</li>
<li>Add an extra constant weight (i.e. a bias term) to this weighted
sum</li>
<li>Apply a non-linear function to the output so far (using a predefined
activation function such as the ReLU function)</li>
</ul></li>
<li>Return one output value, again a floating point number.</li>
</ul><p>One example equation to calculate the output for a neuron is: <span class="math inline">\(output=ReLU(∑i(xi∗wi)+bias)\)</span></p>
<figure><img src="../fig/03_neuron.png" alt="diagram of a single neuron taking multiple inputs and their associated weights in and then applying an activation function to predict a single output" class="figure mx-auto d-block"></figure></div>
<div class="section level3">
<h3 id="combining-multiple-neurons-into-a-network">Combining multiple neurons into a network<a class="anchor" aria-label="anchor" href="#combining-multiple-neurons-into-a-network"></a></h3>
<p>Multiple neurons can be joined together by connecting the output of
one to the input of another. These connections are associated with
weights that determine the ‘strength’ of the connection, and the weights
are adjusted during training. In this way, the combination of neurons
and connections describe a computational graph, an example can be seen
in the image below.</p>
<p>In most neural networks neurons are aggregated into layers. Signals
travel from the input layer to the output layer, possibly through one or
more intermediate layers called hidden layers. The image below
illustrates an example of a neural network with three layers, each
circle is a neuron, each line is an edge and the arrows indicate the
direction data moves in.</p>
<figure><img src="../fig/03_neural_net.png" alt="diagram of a neural with four neurons taking multiple inputs and their weights and predicting multiple outputs" class="figure mx-auto d-block"><div class="figcaption">The image above is by Glosser.ca, <a href="https://creativecommons.org/licenses/by-sa/3.0" class="external-link">CC BY-SA 3.0</a>,
via Wikimedia Commons, <a href="https://commons.wikimedia.org/wiki/File:Colored_neural_network.svg" class="external-link">original
source</a>
</div>
</figure><p>Neural networks aren’t a new technique, they have been around since
the late 1940s. But until around 2010 neural networks tended to be quite
small, consisting of only 10s or perhaps 100s of neurons. This limited
them to only solving quite basic problems. Around 2010 improvements in
computing power and the algorithms for training the networks made much
larger and more powerful networks practical. These are known as deep
neural networks or Deep Learning.</p>
</div>
</section><section id="convolutional-neural-networks"><h2 class="section-heading">Convolutional Neural Networks<a class="anchor" aria-label="anchor" href="#convolutional-neural-networks"></a>
</h2>
<hr class="half-width"><p>A convolutional neural network (CNN) is a type of artificial neural
network (ANN) most commonly applied to analyze visual imagery. They are
designed to recognize the spatial structure of images when extracting
features.</p>
<div class="section level3">
<h3 id="step-4--build-an-architecture-from-scratch-or-choose-a-pretrained-model">Step 4. Build an architecture from scratch or choose a pretrained
model<a class="anchor" aria-label="anchor" href="#step-4--build-an-architecture-from-scratch-or-choose-a-pretrained-model"></a></h3>
<p>Let us explore how to build a neural network from scratch. Although
this sounds like a daunting task, with Keras it is surprisingly
straightforward. With Keras you compose a neural network by creating
layers and linking them together.</p>
</div>
<div class="section level3">
<h3 id="parts-of-a-neural-network">Parts of a neural network<a class="anchor" aria-label="anchor" href="#parts-of-a-neural-network"></a></h3>
<p>There are three main components of a neural network:</p>
<ul><li>CNN Part 1. Input Layer</li>
<li>CNN Part 2. Hidden Layers</li>
<li>CNN Part 3. Output Layer</li>
</ul><p>The output from each layer becomes the input to the next layer.</p>
<div class="section level4">
<h4 id="cnn-part-1--input-layer">CNN Part 1. Input Layer<a class="anchor" aria-label="anchor" href="#cnn-part-1--input-layer"></a></h4>
<p>The Input in Keras gets special treatment when images are used. Keras
automatically calculates the number of inputs and outputs a specific
layer needs and therefore how many edges need to be created. This means
we must let Keras know how big our input is going to be. We do this by
instantiating a <code>keras.Input</code> class and pass it a tuple to
indicate the dimensionality of the input data.</p>
<p>The input layer is created with the <code>tf.keras.Input</code>
function and its first parameter is the expected shape of the input:</p>
<pre><code><span><span class="fu">keras.Input</span><span class="op">(</span>shape<span class="op">=</span><span class="va">None</span>, batch_size<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="va">None</span>, sparse<span class="op">=</span><span class="va">None</span>, batch_shape<span class="op">=</span><span class="va">None</span>, name<span class="op">=</span><span class="va">None</span>, tensor<span class="op">=</span><span class="va">None</span><span class="op">)</span></span></code></pre>
<p>In our case, the shape of an image is defined by its pixel dimensions
and number of channels:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># recall the shape of the images in our dataset</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="bu">print</span>(train_images.shape)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(40000, 32, 32, 3) # number of images, image width in pixels, image height in pixels, number of channels (RGB)</code></pre>
</div>
<div id="challenge-create-the-input-layer-for-our-network" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-create-the-input-layer-for-our-network" class="callout-inner">
<h3 class="callout-title">CHALLENGE Create the input layer for our
network<a class="anchor" aria-label="anchor" href="#challenge-create-the-input-layer-for-our-network"></a>
</h3>
<div class="callout-content">
<p>Hint 1: Specify shape argument only and use defaults for the rest.
Hint 2: The shape of our input dataset includes the total number of
images. We want to take a slice of the shape for a single individual
image to use an input.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>    <span class="co"># CNN Part 1</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>    <span class="co"># Input layer of 32x32 images with three channels (RGB)</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>   inputs_intro <span class="op">=</span> keras.Input(<span class="co">#blank#)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">Show me the solution</h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    # CNN Part 1
    # Input layer of 32x32 images with three channels (RGB)
   inputs_intro = keras.Input(shape=train_images.shape[1:])</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="cnn-part-2--hidden-layers">CNN Part 2. Hidden Layers<a class="anchor" aria-label="anchor" href="#cnn-part-2--hidden-layers"></a></h4>
<p>The next component consists of the so-called hidden layers of the
network. The reason they are referred to as hidden is because the true
values of their nodes are unknown.</p>
<p>In a CNN, the hidden layers typically consist of convolutional,
pooling, reshaping (e.g., Flatten), and dense layers.</p>
<p>Check out the <a href="https://keras.io/api/layers/" class="external-link">Layers API</a>
section of the Keras documentation for each layer type and its
parameters.</p>
<div class="section level5">
<h5 id="convolutional-layers"><strong>Convolutional Layers</strong><a class="anchor" aria-label="anchor" href="#convolutional-layers"></a></h5>
<p>A <strong>convolutional</strong> layer is a fundamental building
block in a CNN designed for processing structured grid data, such as
images. It applies convolution operations to input data using learnable
filters or kernels, extracting local patterns and features (e.g. edges,
corners). These filters enable the network to capture hierarchical
representations of visual information, allowing for effective feature
learning.</p>
<p>To find the particular features of an image, CNNs make use of a
concept from image processing that precedes Deep Learning.</p>
<p>A <strong>convolution matrix</strong>, or <strong>kernel</strong>, is
a matrix transformation that we ‘slide’ over the image to calculate
features at each position of the image. For each pixel, we calculate the
matrix product between the kernel and the pixel with its surroundings.
Here is one example of a 3x3 kernel used to detect edges:</p>
<pre><code>[[-1, -1, -1],
 [0,   0,  0]
 [1,   1,  1]]</code></pre>
<p>This kernel will give a high value to a pixel if it is on a
horizontal border between dark and light areas.</p>
<p>In the following image, the effect of such a kernel on the values of
a single-channel image stands out. The red cell in the output matrix is
the result of multiplying and summing the values of the red square in
the input, and the kernel. Applying this kernel to a real image
demonstrates it does indeed detect horizontal edges.</p>
<figure><img src="../fig/03_conv_matrix.png" alt="6x5 input matrix representing a single colour channel image being multipled by a 3x3 kernel to produce a 4x4 output matrix to detect horizonal edges in an image " class="figure mx-auto d-block"></figure><figure><img src="../fig/03_conv_image.png" alt="single colour channel image of a cat multiplied by a 3x3 kernel to produce an image of a cat where the edges  stand out" class="figure mx-auto d-block"></figure><p>There are several types of convolutional layers available in Keras
depending on your application. We use the two-dimensional layer
typically used for images:</p>
<pre><code>keras.layers.Conv2D(filters, kernel_size, strides=(1, 1), padding="valid", activation=None, **kwargs)</code></pre>
<p>We want to create a Conv2D layer with 16 filters, a 3x3 kernel size,
and the ‘relu’ activation function.</p>
<div id="challenge-create-a-2d-convolutional-layer-for-our-network" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-create-a-2d-convolutional-layer-for-our-network" class="callout-inner">
<h3 class="callout-title">CHALLENGE Create a 2D convolutional layer for
our network<a class="anchor" aria-label="anchor" href="#challenge-create-a-2d-convolutional-layer-for-our-network"></a>
</h3>
<div class="callout-content">
<p>Hint 1: The input to each layer is the output of the previous
layer.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>    <span class="co"># CNN Part 2</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>    <span class="co"># Convolutional layer with 16 filters, 3x3 kernel size, and ReLU activation</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Conv2D(filters<span class="op">=</span><span class="co">#blank#, kernel_size=#blank#, activation=#blank#)(#blank#)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">Show me the solution</h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    # CNN Part 2
    # Convolutional layer with 16 filters, 3x3 kernel size, and ReLU activation
    x_intro = keras.layers.Conv2D(filters=16, kernel_size=(3, 3), activation='relu')(inputs_intro)</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The instantiation here has three parameters and a seemingly strange
combination of parentheses, so let us break it down.</p>
<ul><li>The first parameter is the number of filters in this layer. This is
one of the hyperparameters of our system and should be chosen carefully.
<ul><li>Good practice is to start with a relatively small number of filters
in the first layer to prevent overfitting.</li>
<li>Choosing a number of filters as a power of two (e.g., 32, 64, 128)
is common.</li>
</ul></li>
<li>The second parameter is the kernel size which we already discussed.
Smaller kernels are often used to capture fine-grained features and
odd-sized filters are preferred because they have a centre pixel which
helps maintain spatial symmetry during convolutions.</li>
<li>The third parameter is the activation function to use.
<ul><li>Here we choose <strong>relu</strong> which is one of the most
commonly used in deep neural networks that is proven to work well.</li>
<li>We will discuss activation functions later in <strong>Step 9. Tune
hyperparameters</strong> but to satisfy your curiosity,
<code>ReLU</code> stands for Rectified Linear Unit (ReLU).</li>
</ul></li>
<li>Next is an extra set of parenthenses with inputs in them that means
after an instance of the Conv2D layer is created, it can be called as if
it was a function. This tells the Conv2D layer to connect the layer
passed as a parameter, in this case the inputs.</li>
<li>Finally, we store a reference so we can pass it to the next
layer.</li>
</ul><div id="playing-with-convolutions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="playing-with-convolutions" class="callout-inner">
<h3 class="callout-title">Playing with convolutions<a class="anchor" aria-label="anchor" href="#playing-with-convolutions"></a>
</h3>
<div class="callout-content">
<p>Convolutions applied to images can be hard to grasp at first.
Fortunately, there are resources out there that enable users to
interactively play around with images and convolutions:</p>
<ul><li><p><a href="https://setosa.io/ev/image-kernels/" class="external-link">Image kernels
explained</a> illustrates how different convolutions can achieve certain
effects on an image, like sharpening and blurring.</p></li>
<li><p>The <a href="https://stanford.edu/~shervine/teaching/cs-230/cheatsheet-convolutional-neural-networks" class="external-link">convolutional
neural network cheat sheet</a> provides animated examples of the
different components of convolutional neural nets.</p></li>
</ul></div>
</div>
</div>
<div id="challenge-border-pixels" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-border-pixels" class="callout-inner">
<h3 class="callout-title">CHALLENGE Border pixels<a class="anchor" aria-label="anchor" href="#challenge-border-pixels"></a>
</h3>
<div class="callout-content">
<p>What do you think happens to the border pixels when applying a
convolution?</p>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">Show me the solution</h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" aria-labelledby="headingSolution9" data-bs-parent="#accordionSolution9">
<div class="accordion-body">
<p>There are different ways of dealing with border pixels.</p>
<ul><li>You can ignore them, which means your output image is slightly
smaller then your input.</li>
<li>It is also possible to ‘pad’ the borders, e.g., with the same value
or with zeros, so that the convolution can also be applied to the border
pixels. In that case, the output image will have the same size as the
input image.</li>
</ul></div>
</div>
</div>
</div>
</div>
<div class="section level5">
<h5 id="pooling-layers"><strong>Pooling Layers</strong><a class="anchor" aria-label="anchor" href="#pooling-layers"></a></h5>
<p>The convolutional layers are often intertwined with
<strong>Pooling</strong> layers. As opposed to the convolutional layer
used in feature extraction, the pooling layer alters the dimensions of
the image and reduces it by a scaling factor effectively decreasing the
resolution of your picture.</p>
<p>The rationale behind this is that higher layers of the network should
focus on higher-level features of the image. By introducing a pooling
layer, the subsequent convolutional layer has a broader ‘view’ on the
original image.</p>
<p>Similar to convolutional layers, Keras offers several pooling layers
and one used for images (2D spatial data):</p>
<pre><code>keras.layers.MaxPooling2D(pool_size=(2, 2), strides=None, padding="valid", data_format=None, name=None, **kwargs)</code></pre>
<p>We want to create a pooling layer with input window sized 2,2.</p>
<div id="challenge-create-a-pooling-layer-for-our-network" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-create-a-pooling-layer-for-our-network" class="callout-inner">
<h3 class="callout-title">CHALLENGE Create a Pooling layer for our
network<a class="anchor" aria-label="anchor" href="#challenge-create-a-pooling-layer-for-our-network"></a>
</h3>
<div class="callout-content">
<p>Hint 1: The input to each layer is the output of the previous
layer.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>    <span class="co"># Pooling layer with input window sized 2,2</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.MaxPooling2D(<span class="co">#blank#)(#blank#)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10">Show me the solution</h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" aria-labelledby="headingSolution10" data-bs-parent="#accordionSolution10">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    # Pooling layer with input window sized 2,2
    x_intro = keras.layers.MaxPooling2D(pool_size=(2, 2))(x_intro)</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The instantiation here has a single parameter, pool_size.</p>
<p>The function downsamples the input along its spatial dimensions
(height and width) by taking the <strong>maximum</strong> value over an
input window (of size defined by pool_size) for each channel of the
input. By taking the maximum instead of the average, the most prominent
features in the window are emphasized.</p>
<p>A 2x2 pooling size reduces the width and height of the input by a
factor of 2. Empirically, a 2x2 pooling size has been found to work well
in various for image classification tasks and also strikes a balance
between down-sampling for computational efficiency and retaining
important spatial information.</p>
</div>
<div class="section level5">
<h5 id="dense-layers"><strong>Dense layers</strong><a class="anchor" aria-label="anchor" href="#dense-layers"></a></h5>
<p>A <strong>dense</strong> layer has a number of neurons, which is a
parameter you choose when you create the layer. When connecting the
layer to its input and output layers every neuron in the dense layer
gets an edge (i.e. connection) to <strong>all</strong> of the input
neurons and <strong>all</strong> of the output neurons.</p>
<figure><img src="../fig/03-neural_network_sketch_dense.png" alt="diagram of a neural network with multiple inputs feeding into to two seperate dense layers with connections between all the inputs and outputs" class="figure mx-auto d-block"></figure><p>This layer is called fully connected, because all input neurons are
taken into account by each output neuron. It aggregates global
information about the features learned in previous layers to make a
decision about the class of the input.</p>
<p>In Keras, a densely-connected layer is defined:</p>
<pre><code>keras.layers.Dense(units, activation=None, **kwargs)</code></pre>
<p>Units in this case refer to the number of neurons.</p>
<p>The choice of how many neurons to specify is often determined through
experimentation and can impact the performance of our CNN. Too few
neurons may not capture complex patterns in the data but too many
neurons may lead to overfitting.</p>
<p>We will choose 64 for our dense layer and ‘relu’ activation.</p>
<div id="challenge-create-a-dense-layer-for-our-network" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-create-a-dense-layer-for-our-network" class="callout-inner">
<h3 class="callout-title">CHALLENGE Create a Dense layer for our
network<a class="anchor" aria-label="anchor" href="#challenge-create-a-dense-layer-for-our-network"></a>
</h3>
<div class="callout-content">
<p>Hint 1: The input to each layer is the output of the previous
layer.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>    <span class="co"># Dense layer with 64 neurons and ReLU activation</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Dense(units<span class="op">=</span><span class="co">#hidden#, activation=#hidden#)(#hidden#)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution11" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution11" aria-expanded="false" aria-controls="collapseSolution11">
  <h4 class="accordion-header" id="headingSolution11">Show me the solution</h4>
</button>
<div id="collapseSolution11" class="accordion-collapse collapse" aria-labelledby="headingSolution11" data-bs-parent="#accordionSolution11">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>    <span class="co"># Dense layer with 64 neurons and ReLU activation</span></span>
<span>    <span class="va">x_intro</span> <span class="op">=</span> <span class="fu">keras.layers.Dense</span><span class="op">(</span><span class="fl">64</span>, activation<span class="op">=</span><span class="st">'relu'</span><span class="op">)</span><span class="op">(</span><span class="va">x_intro</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level5">
<h5 id="reshaping-layers-flatten"><strong>Reshaping Layers: Flatten</strong><a class="anchor" aria-label="anchor" href="#reshaping-layers-flatten"></a></h5>
<p>The next type of hidden layer used in our introductory model is a
type of reshaping layer defined in Keras by the
<code>tf.keras.layers.Flatten</code> class. It is necessary when
transitioning from convolutional and pooling layers to fully connected
layers.</p>
<pre><code>keras.layers.Flatten(data_format=None, **kwargs)</code></pre>
<p>The <strong>Flatten</strong> layer converts the output of the
previous layer into a single one-dimensional vector that can be used as
input for a dense layer.</p>
<div id="challenge-create-a-flatten-layer-for-our-network" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-create-a-flatten-layer-for-our-network" class="callout-inner">
<h3 class="callout-title">CHALLENGE Create a Flatten layer for our
network<a class="anchor" aria-label="anchor" href="#challenge-create-a-flatten-layer-for-our-network"></a>
</h3>
<div class="callout-content">
<p>Hint 1: The input to each layer is the output of the previous
layer.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>    <span class="co"># Flatten layer to convert 2D feature maps into a 1D vector</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Flatten()(<span class="op">=</span><span class="co">#hidden#)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution12" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution12" aria-expanded="false" aria-controls="collapseSolution12">
  <h4 class="accordion-header" id="headingSolution12">Show me the solution</h4>
</button>
<div id="collapseSolution12" class="accordion-collapse collapse" aria-labelledby="headingSolution12" data-bs-parent="#accordionSolution12">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>    <span class="co"># Flatten layer to convert 2D feature maps into a 1D vector</span></span>
<span>    <span class="va">x_intro</span> <span class="op">=</span> <span class="fu">keras.layers.Flatten</span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">x_intro</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler11" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler11" aria-expanded="false" aria-controls="collapseSpoiler11">
  <h3 class="accordion-header" id="headingSpoiler11">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>What does Flatten mean exactly?</h3>
</button>
<div id="collapseSpoiler11" class="accordion-collapse collapse" aria-labelledby="headingSpoiler11" data-bs-parent="#accordionSpoiler11">
<div class="accordion-body">
<p>A flatten layer function is typically used to transform the
two-dimensional arrays (matrices) generated by the convolutional and
pooling layers into a one-dimensional array. This is necessary when
transitioning from the convolutional/pooling layers to the fully
connected layers, which require one-dimensional input.</p>
<p>During the convolutional and pooling operations, a neural network
extracts features from the input images, resulting in multiple feature
maps, each represented by a matrix. These feature maps capture different
aspects of the input image, such as edges, textures, or patterns.
However, to feed these features into a fully connected layer for
classification or regression tasks, they must be a single vector.</p>
<p>The flatten layer takes each element from the feature maps and
arranges them into a single long vector, concatenating them along a
single dimension. This transformation preserves the spatial
relationships between the features in the original image while providing
a suitable format for the fully connected layers to process.</p>
</div>
</div>
</div>
</div>
<div id="is-one-layer-of-each-type-enough" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="is-one-layer-of-each-type-enough" class="callout-inner">
<h3 class="callout-title">Is one layer of each type enough?<a class="anchor" aria-label="anchor" href="#is-one-layer-of-each-type-enough"></a>
</h3>
<div class="callout-content">
<p>Not for complex data!</p>
<p>A typical architecture for image classification is likely to include
at least one convolutional layer, one pooling layer, one or more dense
layers, and possibly a flatten layer.</p>
<p>Convolutional and Pooling layers are often used together in multipe
sets to capture a wider range of features and learn more complex
representations of the input data. Using this technique, the network can
learn a hierarchical representation of features, where simple features
detected in early layers are combined to form more complex features in
deeper layers.</p>
<p>There isn’t a strict rule of thumb for the number of sets of
convolutional and pooling layers to start with, however, there are some
guidelines.</p>
<p>We are starting with a relatively small and simple architecture
because we are limited in time and computational resources. A simple CNN
with one or two sets of convolutional and pooling layers can still
achieve decent results for many tasks but for your network you will
experiment with different architectures.</p>
</div>
</div>
</div>
<div id="challenge-using-the-four-layers-above-create-a-hidden-layer-architecture-that-contains" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-using-the-four-layers-above-create-a-hidden-layer-architecture-that-contains" class="callout-inner">
<h3 class="callout-title">CHALLENGE Using the four layers above, create
a hidden layer architecture that contains:<a class="anchor" aria-label="anchor" href="#challenge-using-the-four-layers-above-create-a-hidden-layer-architecture-that-contains"></a>
</h3>
<div class="callout-content">
<ul><li>2 sets of Conv2D and Pooling layers, with 16 and 32 filters
respectively</li>
<li>1 Flatten layer</li>
<li>1 Dense layer with</li>
</ul><p>Hint 1: The input to each layer is the output of the previous
layer.</p>
</div>
</div>
</div>
<div id="accordionSolution13" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution13" aria-expanded="false" aria-controls="collapseSolution13">
  <h4 class="accordion-header" id="headingSolution13">Show me the solution</h4>
</button>
<div id="collapseSolution13" class="accordion-collapse collapse" aria-labelledby="headingSolution13" data-bs-parent="#accordionSolution13">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    # CNN Part 2
    # Convolutional layer with 16 filters, 3x3 kernel size, and ReLU activation
    x_intro = keras.layers.Conv2D(16, (3, 3), activation='relu')(inputs_intro)
    # Pooling layer with input window sized 2,2
    x_intro = keras.layers.MaxPooling2D((2, 2))(x_intro)
    # Second Convolutional layer with 32 filters, 3x3 kernel size, and ReLU activation
    x_intro = keras.layers.Conv2D(32, (3, 3), activation='relu')(x_intro)
    # Second Pooling layer with input window sized 2,2
    x_intro = keras.layers.MaxPooling2D((2, 2))(x_intro)
    # Flatten layer to convert 2D feature maps into a 1D vector
    x_intro = keras.layers.Flatten()(x_intro)
    # Dense layer with 64 neurons and ReLU activation
    x_intro = keras.layers.Dense(64, activation='relu')(x_intro)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="cnn-part-3--output-layer">CNN Part 3. Output Layer<a class="anchor" aria-label="anchor" href="#cnn-part-3--output-layer"></a></h4>
<p>Recall for the outputs we asked ourselves what we want to identify
from the data. If we are performing a classification problem, then
typically we have one output for each potential class.</p>
<p>In traditional CNN architectures, a dense layer is typically used as
the final layer for classification. This dense layer receives the
flattened feature maps from the preceding convolutional and pooling
layers and outputs the final class probabilities or regression
values.</p>
<p>For multiclass data, the <code>softmax</code> activation is used
instead of <code>relu</code> because it helps the computer give each
option (class) a likelihood score, and the scores add up to 100 per
cent. This way, it’s easier to pick the one the computer thinks is most
probable.</p>
<div id="challenge-create-an-output-layer-for-our-network-using-a-dense-layer" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-create-an-output-layer-for-our-network-using-a-dense-layer" class="callout-inner">
<h3 class="callout-title">CHALLENGE Create an Output layer for our
network using a Dense layer<a class="anchor" aria-label="anchor" href="#challenge-create-an-output-layer-for-our-network-using-a-dense-layer"></a>
</h3>
<div class="callout-content">
<p>Hint 1: The input to each layer is the output of the previous layer.
Hint 2: The units (neurons) should be the same as number of classes as
our dataset. Hint 3: Use softmax activation.</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>    <span class="co"># CNN Part 3</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>    <span class="co"># Output layer with 10 units (one for each class) and softmax activation</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>    outputs_intro <span class="op">=</span> keras.layers.Dense(units<span class="op">=</span><span class="co">#hidden#, activation=#hidden#)(#hidden#)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution14" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution14" aria-expanded="false" aria-controls="collapseSolution14">
  <h4 class="accordion-header" id="headingSolution14">Show me the solution</h4>
</button>
<div id="collapseSolution14" class="accordion-collapse collapse" aria-labelledby="headingSolution14" data-bs-parent="#accordionSolution14">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>    <span class="co"># CNN Part 3</span></span>
<span>    <span class="co"># Output layer with 10 units (one for each class) and softmax activation</span></span>
<span>    <span class="va">outputs_intro</span> <span class="op">=</span> <span class="fu">keras.layers.Dense</span><span class="op">(</span><span class="fl">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span><span class="op">)</span><span class="op">(</span><span class="va">x_intro</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="putting-it-all-together"><h2 class="section-heading">Putting it all together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h2>
<hr class="half-width"><div id="challenge-create-a-function-that-defines-a-cnn-using-the-input-hidden-and-output-layers-in-previous-challenges." class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-create-a-function-that-defines-a-cnn-using-the-input-hidden-and-output-layers-in-previous-challenges." class="callout-inner">
<h3 class="callout-title">CHALLENGE Create a function that defines a CNN
using the input, hidden, and output layers in previous challenges.<a class="anchor" aria-label="anchor" href="#challenge-create-a-function-that-defines-a-cnn-using-the-input-hidden-and-output-layers-in-previous-challenges."></a>
</h3>
<div class="callout-content">
<p>Hint 1: The input to each layer is the output of the previous layer.
Hint 2: The units (neurons) should be the same as number of classes as
our dataset. Hint 3: Use softmax activation.</p>
</div>
</div>
</div>
<div id="accordionSolution15" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution15" aria-expanded="false" aria-controls="collapseSolution15">
  <h4 class="accordion-header" id="headingSolution15">Show me the solution</h4>
</button>
<div id="collapseSolution15" class="accordion-collapse collapse" aria-labelledby="headingSolution15" data-bs-parent="#accordionSolution15">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>    <span class="co"># CNN Part 3</span></span>
<span>    <span class="co"># Output layer with 10 units (one for each class) and softmax activation</span></span>
<span>    <span class="va">outputs_intro</span> <span class="op">=</span> <span class="fu">keras.layers.Dense</span><span class="op">(</span><span class="fl">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span><span class="op">)</span><span class="op">(</span><span class="va">x_intro</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="kw">def</span> create_model_intro():</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>    </span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>    <span class="co"># CNN Part 1</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>    <span class="co"># Input layer of 32x32 images with three channels (RGB)</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>    inputs_intro <span class="op">=</span> keras.Input(shape<span class="op">=</span>train_images.shape[<span class="dv">1</span>:])</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>    </span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>    <span class="co"># CNN Part 2</span></span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>    <span class="co"># Convolutional layer with 16 filters, 3x3 kernel size, and ReLU activation</span></span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Conv2D(<span class="dv">16</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>)(inputs_intro)</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>    <span class="co"># Pooling layer with input window sized 2,2</span></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.MaxPooling2D((<span class="dv">2</span>, <span class="dv">2</span>))(x_intro)</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>    <span class="co"># Second Convolutional layer with 32 filters, 3x3 kernel size, and ReLU activation</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>)(x_intro)</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>    <span class="co"># Second Pooling layer with input window sized 2,2</span></span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.MaxPooling2D((<span class="dv">2</span>, <span class="dv">2</span>))(x_intro)</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>    <span class="co"># Flatten layer to convert 2D feature maps into a 1D vector</span></span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Flatten()(x_intro)</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>    <span class="co"># Dense layer with 64 neurons and ReLU activation</span></span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(x_intro)</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>    </span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>    <span class="co"># CNN Part 3</span></span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>    <span class="co"># Output layer with 10 units (one for each class) and softmax activation</span></span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>    outputs_intro <span class="op">=</span> keras.layers.Dense(<span class="dv">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span>)(x_intro)</span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a>    </span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a>    <span class="co"># create the model</span></span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a>    model_intro <span class="op">=</span> keras.Model(inputs <span class="op">=</span> inputs_intro, </span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>                              outputs <span class="op">=</span> outputs_intro, </span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a>                              name <span class="op">=</span> <span class="st">"cifar_model_intro"</span>)</span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a>    </span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a>    <span class="cf">return</span> model_intro</span></code></pre>
</div>
<p>Use the function you created to create the introduction model and
view a summary of it’s structure.</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># create the introduction model</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>model_intro <span class="op">=</span> create_model_intro()</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="co"># view model summary</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>model_intro.summary()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Model: "cifar_model_intro"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 32, 32, 3)]       0         
                                                                 
 conv2d (Conv2D)             (None, 30, 30, 16)        448       
                                                                 
 max_pooling2d (MaxPooling2  (None, 15, 15, 16)        0         
 D)                                                              
                                                                 
 conv2d_1 (Conv2D)           (None, 13, 13, 32)        4640      
                                                                 
 max_pooling2d_1 (MaxPoolin  (None, 6, 6, 32)          0         
 g2D)                                                            
                                                                 
 flatten (Flatten)           (None, 1152)              0         
                                                                 
 dense (Dense)               (None, 64)                73792     
                                                                 
 dense_1 (Dense)             (None, 10)                650       
                                                                 
=================================================================
Total params: 79530 (310.66 KB)
Trainable params: 79530 (310.66 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________</code></pre>
</div>
<div id="how-to-choose-an-architecture" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="how-to-choose-an-architecture" class="callout-inner">
<h3 class="callout-title">How to choose an architecture?<a class="anchor" aria-label="anchor" href="#how-to-choose-an-architecture"></a>
</h3>
<div class="callout-content">
<p>Even for this neural network, we had to make a choice on the number
of hidden neurons. Other choices to be made are the number of layers and
type of layers. You might wonder how you should make these architectural
choices. Unfortunately, there are no clear rules to follow here, and it
often boils down to a lot of trial and error. However, it is recommended
to explore what others have done with similar datasets and problems.
Another best practice is to start with a relatively simple architecture.
Once running start to add layers and tweak the network to test if
performance increases.</p>
</div>
</div>
</div>
</section><section id="we-have-a-model-now-what"><h2 class="section-heading">We have a model now what?<a class="anchor" aria-label="anchor" href="#we-have-a-model-now-what"></a>
</h2>
<hr class="half-width"><p>This CNN should be able to run with the CIFAR-10 dataset and provide
reasonable results for basic classification tasks. However, do keep in
mind this model is relatively simple, and its performance may not be as
high as more complex architectures. The reason it’s called deep learning
is because in most cases, the more layers we have, i.e. the deeper and
more sophisticated CNN architecture we use, the better the
performance.</p>
<p>How can we tell? We can inspect a couple metrics produced during the
training process to detect whether our model is underfitting or
overfitting. To do that, we continue with the next steps in our Deep
Learning workflow, <strong>Step 5. Choose a loss function and
optimizer</strong> and <strong>Step 6. Train model</strong>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Artificial neural networks (ANN) are a machine learning technique
based on a model inspired by groups of neurons in the brain.</li>
<li>Convolution neural networks (CNN) are a type of ANN designed for
image classification and object detection.</li>
<li>The number of filters corresponds to the number of distinct features
the layer is learning to recognise whereas the kernel size determines
the level of features being captured.</li>
<li>A CNN can consist of many types of layers including convolutional,
pooling, flatten, and dense (fully connected) layers</li>
<li>Convolutional layers are responsible for learning features from the
input data.</li>
<li>Pooling layers are often used to reduce the spatial dimensions of
the data.</li>
<li>The flatten layer is used to convert the multi-dimensional output of
the convolutional and pooling layers into a flat vector.</li>
<li>Dense layers are responsible for combining features learned by the
previous layers to perform the final classification.</li>
</ul></div>
</div>
</div>
<!-- Collect your link references at the bottom of your document -->
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-text-preprocessing.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-word-embedding.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-text-preprocessing.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Introduction to Text
        </a>
        <a class="chapter-link float-end" href="../instructor/04-word-embedding.html" rel="next">
          Next: Word Embedding... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/qcif-training/intro_nlp_lmm_v1.0/edit/main/episodes/03-text-analysis.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/qcif-training/intro_nlp_lmm_v1.0/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/qcif-training/intro_nlp_lmm_v1.0/" class="external-link">Source</a></p>
				<p><a href="https://github.com/qcif-training/intro_nlp_lmm_v1.0/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:training@qcif.edu.au">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://qcif-training.github.io/intro_nlp_lmm_v1.0/instructor/03-text-analysis.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Text Analysis",
  "creativeWorkStatus": "active",
  "url": "https://qcif-training.github.io/intro_nlp_lmm_v1.0/instructor/03-text-analysis.html",
  "identifier": "https://qcif-training.github.io/intro_nlp_lmm_v1.0/instructor/03-text-analysis.html",
  "dateCreated": "2024-05-10",
  "dateModified": "2024-05-12",
  "datePublished": "2024-05-12"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

